#!/usr/bin/python3

import iprottation

def response_handler(response):

	if response.status_code:
		print(f'{response.url}      -        {response.status_code}')

def wordlist(filename):
	with open(filename) as fileobj:
		for word in fileobj:
			yield word.rstrip()

def url_generator(url,wordlist):
	for word in wordlist:
		yield url+'/'+word,{}


def main():
	dictionary = wordlist('/usr/share/wordlists/dirb/common.txt')
	url = url_generator('https://example.com',dictionary)
	method = 'GET'
	thread_lmt = 15
	handler = response_handler
	sleep_time = 10

	iprottation.IProtator(url,method,thread_lmt,handler,sleep_time)

if __name__ == '__main__':

	main()
	
